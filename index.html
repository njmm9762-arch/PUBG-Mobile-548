<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tik NEGM</title>
<style>
body,html{margin:0;padding:0;height:100%;overflow:hidden;background:#000;color:#fff;font-family:Arial,sans-serif;}
#startScreen{position:fixed;inset:0;background:#000;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:1000;}
#startScreen img{width:120px;margin-bottom:30px;}
#startBtn{padding:15px 40px;font-size:18px;border:none;border-radius:30px;background:#ff0050;color:#fff;cursor:pointer;}
#app{position:relative;width:100%;height:100vh;overflow:hidden;display:none;}
video{width:100%;height:100%;object-fit:contain;}
.top-bar{position:absolute;top:10px;left:10px;z-index:1000;font-size:26px;font-weight:bold;color:#00f2ea;}
.top-bar span{color:#ff0050;}
.side-actions{position:absolute;right:10px;bottom:120px;display:flex;flex-direction:column;gap:20px;align-items:center;}
.side-actions img{width:45px;height:45px;border-radius:50%;border:2px solid #fff;cursor:pointer;}
.side-actions .action{font-size:26px;text-align:center;cursor:pointer;display:flex;flex-direction:column;align-items:center;position:relative;}
.side-actions .action small{font-size:14px;margin-top:4px;}
.share-popup{position:absolute;bottom:50px;right:50px;background:#111;padding:10px;border-radius:10px;display:none;flex-direction:column;gap:10px;z-index:2000;}
.share-popup div{display:flex;justify-content:space-around;}
.share-popup div div{cursor:pointer;text-align:center;}
.bottom-info{position:absolute;bottom:20px;left:10px;}
.bottom-info .username{font-size:26px;font-weight:900;}
.bottom-info .desc{font-size:16px;opacity:0.9;}
#profile{display:none;background:#000;min-height:100vh;padding-top:70px;}
.profile-header{text-align:center;}
.profile-header img{width:90px;height:90px;border-radius:50%;}
.profile-header h2{margin:10px 0 5px;}
.profile-header span{opacity:0.7;display:block;}
.profile-videos{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;margin-top:20px;}
.profile-videos .vidWrapper{position:relative;}
.profile-videos video{width:100%;height:200px;object-fit:contain;cursor:pointer;}
.profile-videos .viewsBadge{position:absolute;bottom:5px;left:5px;color:#fff;font-size:12px;background:rgba(0,0,0,0.5);padding:2px 4px;border-radius:4px;}
.follow{background:#ff0050;padding:6px 14px;border-radius:6px;display:inline-block;margin-top:10px;cursor:pointer;}
#heart{position:absolute;font-size:80px;color:red;opacity:0;transform:translate(-50%,-50%);pointer-events:none;transition:opacity 0.4s,transform 0.4s;}
#fullScreenBtn{position:absolute;top:50%;right:10px;transform:translateY(-50%);background:rgba(0,0,0,0.5);padding:10px;border-radius:50%;cursor:pointer;z-index:1000;font-size:24px;}
</style>
</head>
<body>

<div id="startScreen">
  <img src="914512268067030319.jpeg">
  <button id="startBtn">Ø§Ø¶ØºØ· Ù„Ù„Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="app">
  <div class="top-bar">Tik <span>NEGM</span></div>
  <video id="videoPlayer" autoplay playsinline muted></video>
  <div id="heart">â¤ï¸</div>
  <div id="fullScreenBtn">â›¶</div>

  <div class="side-actions">
    <img src="914512268067030319.jpeg" onclick="openProfile()">
    <div class="action" id="likeBtn">
      â¤ï¸
      <small id="likeCount">0</small>
    </div>
    <div class="action" onclick="alert('Ù…Ø¹Ù„Ù‚ Ø­Ø§Ù„ÙŠÙ‹Ø§')">ğŸ’¬</div>
    <div class="action" id="shareBtn">â¥
      <small id="shareCount">0</small>
      <div class="share-popup" id="sharePopup">
        <div>
          <div onclick="downloadVideo()">â†“<br>ØªÙ†Ø²ÙŠÙ„</div>
          <div onclick="copyLink()">ğŸ”—<br>Ù†Ø³Ø®</div>
          <div onclick="shareVideo()">ğŸ’Œ<br>Ù…Ø´Ø§Ø±ÙƒØ©</div>
        </div>
      </div>
    </div>
  </div>

  <div class="bottom-info">
    <div class="username">â˜… Tik NEGM â˜…</div>
    <div class="desc" id="videoDesc">ÙÙŠØ¯ÙŠÙˆ Ø¬Ù…ÙŠÙ„</div>
    <div class="follow">Ù…ØªØ§Ø¨Ø¹Ø© Â· 2 Ù…Ù„ÙŠØ§Ø±</div>
  </div>
</div>

<div id="profile">
  <div class="profile-header">
    <img src="914512268067030319.jpeg">
    <h2>Tik NEGM</h2>
    <span>2 Ù…Ù„ÙŠØ§Ø± Ù…ØªØ§Ø¨Ø¹</span>
  </div>
  <div class="profile-videos" id="profileVideos"></div>
</div>

<script>
let videos = []; 
let index = 0; 
let liked = false;
const videoPlayer = document.getElementById("videoPlayer");
const likeBtn = document.getElementById("likeBtn");
const likeCount = document.getElementById("likeCount");
const shareCount = document.getElementById("shareCount");
const videoDesc = document.getElementById("videoDesc");
const heart = document.getElementById("heart");
const app = document.getElementById("app");
const startScreen = document.getElementById("startScreen");
const shareBtn = document.getElementById("shareBtn");
const sharePopup = document.getElementById("sharePopup");
const fullScreenBtn = document.getElementById("fullScreenBtn");
let isFullScreen = false;

// Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„
document.getElementById("startBtn").onclick = () => {
  startScreen.style.display = "none";
  app.style.display = "block";
  videoPlayer.muted = false; 
  fetch('data.json')
    .then(res => res.json())
    .then(data => { videos = data; loadVideo(); })
    .catch(()=>alert("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!"));
};

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø­Ø¬Ù…
function loadVideo(){
  if(videos.length === 0) return;
  const v = videos[index];
  videoPlayer.src = v.src;
  likeCount.innerText = v.likes;
  shareCount.innerText = v.shares;
  videoDesc.innerText = v.desc;
  liked = false;

  videoPlayer.play().catch(()=>{});

  videoPlayer.onloadedmetadata = ()=>{
    const ratio = videoPlayer.videoWidth / videoPlayer.videoHeight;
    if(ratio > 1){ // Landscape
      videoPlayer.style.objectFit = "contain";
      fullScreenBtn.style.display = "block";
    } else { // Portrait
      videoPlayer.style.objectFit = "cover";
      fullScreenBtn.style.display = "none";
    }
  }
}

// Scroll Ø³Ù„Ø³
let startY = 0;
document.addEventListener("touchstart", e => startY = e.touches[0].clientY);
document.addEventListener("touchend", e => {
  let endY = e.changedTouches[0].clientY;
  if(startY - endY > 50) nextVideo();
  if(endY - startY > 50) prevVideo();
});
function nextVideo(){ index = (index + 1) % videos.length; loadVideo(); }
function prevVideo(){ index = (index - 1 + videos.length) % videos.length; loadVideo(); }

// Ø¯Ø¨Ù„ ØªØ§Ø¨ + Ù‚Ù„Ø¨
videoPlayer.addEventListener("dblclick", e => {
  liked = true;
  likeBtn.innerText = "â¤ï¸\n" + videos[index].likes;
  heart.style.left = e.clientX + "px";
  heart.style.top = e.clientY + "px";
  heart.style.opacity = 1;
  heart.style.transform = "translate(-50%, -50%) scale(1.5)";
  setTimeout(()=>{heart.style.opacity = 0; heart.style.transform="translate(-50%, -50%) scale(1)";},400);
});

// Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ + Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
function openProfile(){
  app.style.display = "none";
  document.getElementById("profile").style.display = "block";
  const container = document.getElementById("profileVideos");
  container.innerHTML = "";
  videos.forEach(v => {
    const vidWrapper = document.createElement("div");
    vidWrapper.className = "vidWrapper";

    const vid = document.createElement("video");
    vid.src = v.src; vid.muted = true; vid.loop = true;
    vid.onclick = ()=>{document.getElementById("profile").style.display="none"; app.style.display="block";};

    const views = document.createElement("div");
    views.className="viewsBadge";
    views.innerText = `${v.views} Ù…Ø´Ø§Ù‡Ø¯Ø©`;

    vidWrapper.appendChild(vid);
    vidWrapper.appendChild(views);
    container.appendChild(vidWrapper);
  });
}

// Full Screen Ø²Ø±
fullScreenBtn.onclick = ()=>{
  if(!isFullScreen){
    videoPlayer.style.objectFit = "cover";
    videoPlayer.style.width = "100vw";
    videoPlayer.style.height = "100vh";
    fullScreenBtn.innerText = "ğŸ——";
    isFullScreen = true;
  } else {
    videoPlayer.style.objectFit = "contain";
    videoPlayer.style.width = "100%";
    videoPlayer.style.height = "100%";
    fullScreenBtn.innerText = "â›¶";
    isFullScreen = false;
  }
};

// Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
shareBtn.onclick = (e)=>{
  e.stopPropagation();
  sharePopup.style.display = sharePopup.style.display === 'flex' ? 'none':'flex';
};

// ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ø³Ù… Ø«Ø§Ø¨Øª
function downloadVideo(){
  const a = document.createElement('a');
  a.href = videos[index].src;
  a.download = 'tiknegm.mp4';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

// Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
function copyLink(){
  const videoUrl = videos[index].src;
  navigator.clipboard.writeText(videoUrl).then(()=> alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!'));
}

// Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ù„Ù‰ Ø£ÙŠ ØªØ·Ø¨ÙŠÙ‚
function shareVideo(){
  if(navigator.share){
    navigator.share({
      title: 'ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Tik NEGM',
      text: 'Ø´Ø§Ù‡Ø¯ Ù‡Ø°Ø§ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ!',
      url: videos[index].src
    }).catch(err => console.log(err));
  } else {
    alert('Ø®Ø§ØµÙŠØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­');
  }
}
</script>

</body>
</html>
